const express = require('express'); const router = express.Router(); const db = require('../db'); router.get('/', async (req, res) => { try { const [rows] = await db.query('SELECT * FROM payroll_periods'); res.json(rows); } catch (err) { console.error(err); res.status(500).send('Server Error'); } }); module.exports = router;
router.get('/:id', async (req, res) => { try { const [rows] = await db.query('SELECT * FROM payroll_periods WHERE id = ?', [req.params.id]); res.json(rows[0]); } catch (err) { console.error(err); res.status(500).send('Server Error'); } });
router.post('/', async (req, res) => { try { const { period_name, date_start, date_end, frequency } = req.body; const [result] = await db.query('INSERT INTO payroll_periods (period_name, date_start, date_end, frequency) VALUES (?, ?, ?, ?)', [period_name, date_start, date_end, frequency]); res.json({ id: result.insertId }); } catch (err) { console.error(err); res.status(500).send('Server Error'); } });
router.put('/:id', async (req, res) => { try { const { period_name, date_start, date_end, frequency, is_open } = req.body; await db.query('UPDATE payroll_periods SET period_name = ?, date_start = ?, date_end = ?, frequency = ?, is_open = ? WHERE id = ?', [period_name, date_start, date_end, frequency, is_open, req.params.id]); res.sendStatus(200); } catch (err) { console.error(err); res.status(500).send('Server Error'); } });
router.delete('/:id', async (req, res) => { try { await db.query('DELETE FROM payroll_periods WHERE id = ?', [req.params.id]); res.sendStatus(200); } catch (err) { console.error(err); res.status(500).send('Server Error'); } });
